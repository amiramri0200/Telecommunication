clc 
clear all 
close all
xk = [1 2 2 2]% start point
c1 = 0.0001;
c2 = 0.9;
alpha_max = 10;
i = 1;
syms x x1 x2 x3 x4;
Powell = ((x1+10*x2)^2)+5*((x3-x4)^2)+((x2-2*x3)^4)+(10*(x1-x4)^4);
powell_gradient = gradient(Powell) ;
powell_hessi = hessian(Powell) ;
H0 = double(subs(powell_hessi,{x1 x2 x3 x4},{xk}));
ck = inv(H0);
gk = 1;
while norm(gk) > 0.1
    
    gk = double(subs(powell_gradient,{x1,x2,x3,x4},{xk}));
    
    pk=transpose(ck*gk);
    temp = xk - x*(pk);
   
    phi_alpha = subs(Powell,{x1,x2,x3,x4},{temp}) ;
   
    alpha_star  = Linesearch(alpha_max,c1,c2,phi_alpha,x) ;
    
    xk_new = xk - alpha_star*pk;
   
    gk_new = double(subs(powell_gradient,{x1,x2,x3,x4},{xk_new})) ;
   
    delta_k = xk_new - xk ;
    
    gama_k = gk_new - gk ;
   
    a = 1 /((delta_k)*(gama_k)) ;
    %???? ??? ??? ????? ????? ??????? ???? xk ???? ?? ?? ??????? ?????? ??
          %???? ????? ??? ??? ?? ?????? ?? ????? ?????? n*1 ?????? ?? ????
   %???????? ?? xk ?? ?? ????? ??? ?? ?? ??? delta ??????? ???? ?? ???????
    %?? ? ????? ???????? ?? ??????? ?? ??????? ???? ?? ???? ?? ??? ???????
   %??????                                                                
    ck_new = ((eye(4)-a*(transpose(delta_k)*transpose(gama_k)))*ck*(eye(4)-a*gama_k*delta_k))+a*(transpose(delta_k)*delta_k);
   
    ck = ck_new;
    gk = gk_new;
    xk = xk_new;
    
    final_value = double(subs(Powell,{x1,x2,x3,x4},{xk}))%calculating the value of the function at each iteration
    
    i = i + 1;

end